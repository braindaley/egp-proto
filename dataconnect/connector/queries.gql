# Get a user's primary representatives
query GetUserRepresentatives($userId: String!) @auth(level: USER, insecureReason: "Users can query their own representatives by providing their own userId") {
  userRepresentativess(where: {userId: {eq: $userId}, isPrimary: {eq: true}}) {
    contactDirectory {
      contactId
      name
      title
      contactType
      party
      email
      phone
      preferredContactMethod
      responsivenessScore
    }
    representativeType
  }
}

# Get contact details for legislators by bioguideId
query GetContactsByBioguideIds($bioguideIds: [String!]) @auth(level: PUBLIC, insecureReason: "Public directory of representatives") {
  contactDirectories(where: {bioguideId: {in: $bioguideIds}, isActive: {eq: true}}) {
    contactId
    name
    title
    party
    state
    district
    email
    responsivenessScore
    tags
  }
}

# Search for contacts
query SearchContacts($searchTerm: String!, $contactTypes: [String!], $states: [String!]) @auth(level: PUBLIC, insecureReason: "Public directory search") {
  contactDirectories(where: {
    _and: [
      {_or: [
        {name: {pattern: {like: $searchTerm}}},
        {title: {pattern: {like: $searchTerm}}}
      ]},
      {contactType: {in: $contactTypes}},
      {state: {in: $states}},
      {isActive: {eq: true}}
    ]
  }) {
    contactId
    name
    title
    contactType
    party
    state
    district
    responsivenessScore
  }
}

# Get user profile data by UUID
query GetUser($id: UUID!) @auth(level: USER, insecureReason: "Users can query their own profile by providing their own UUID") {
  users(id: $id) {
    id
    userId
    email
    firstName
    lastName
    address
    city
    state
    zipCode
    congressionalDistrict
    politicalAffiliation
    education
    profession
  }
}
